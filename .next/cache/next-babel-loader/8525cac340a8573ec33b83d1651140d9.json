{"ast":null,"code":"import PermissionDeniedError from '../api/core/error';\nimport RLP from 'rlp';\nimport BigNumber from 'bignumber.js';\nimport etherUnits from '../lib/etherUnits';\n\nvar hex2ascii = function hex2ascii(hexIn) {\n  var hex = hexIn.toString();\n  var str = '';\n\n  try {\n    var ba = RLP.decode(hex);\n    var test = ba[1].toString('ascii');\n\n    if (test == 'geth' || test == 'Parity') {\n      // FIXME\n      ba[0] = ba[0].toString('hex');\n    }\n\n    str = baToString(ba);\n  } catch (e) {\n    for (var i = 0; i < hex.length; i += 2) {\n      str += String.fromCharCode(parseInt(hex.substr(i, 2), 16));\n    }\n  }\n\n  return str;\n}; // 日期转换\n\n\nexport var formatDate = function formatDate(date) {\n  date = new Date(date);\n  var y = date.getFullYear();\n  var m = date.getMonth() + 1;\n  var d = date.getDate();\n  var h = date.getHours();\n  var m1 = date.getMinutes();\n  m1 < 10 && (m1 = '0' + m1);\n  m = m < 10 ? '0' + m : m;\n  d = d < 10 ? '0' + d : d;\n  return y + '-' + m + '-' + d + ' ' + h + ':' + m1;\n};\nexport var getDayName = function getDayName(serTime) {\n  var td = new Date();\n  td = new Date(td.getFullYear(), td.getMonth(), td.getDate());\n  var od = new Date(serTime.replace(/-/g, '/'));\n  od = new Date(od.getFullYear(), od.getMonth(), od.getDate());\n  var xc = (od - td) / 1000 / 60 / 60 / 24;\n\n  if (xc < -2) {\n    return \"\".concat(-xc, \"\\u5929\\u524D\");\n  } else if (xc < -1) {\n    return '前天';\n  } else if (xc < 0) {\n    return '昨天';\n  } else if (xc === 0) {\n    return '今天';\n  } else if (xc < 2) {\n    return '明天';\n  } else if (xc < 3) {\n    return '后天';\n  } else {\n    return \"\".concat(xc, \"\\u5929\\u540E\");\n  }\n};\nexport var parseQueryString = function parseQueryString(url) {\n  var obj = {};\n  var str = url.substr(url.indexOf('?') + 1);\n  var arr = str.split('&');\n\n  for (var i = 0; i < arr.length; i++) {\n    var arr2 = arr[i].split('=');\n    obj[arr2[0]] = arr2[1];\n  }\n\n  return obj;\n};\nexport var colorRgb = function colorRgb(sColor) {\n  //十六进制颜色值的正则表达式\n  var reg = /^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/; // 如果是16进制颜色\n\n  if (sColor && reg.test(sColor)) {\n    if (sColor.length === 4) {\n      var sColorNew = '#';\n\n      for (var i = 1; i < 4; i += 1) {\n        sColorNew += sColor.slice(i, i + 1).concat(sColor.slice(i, i + 1));\n      }\n\n      sColor = sColorNew;\n    } //处理六位的颜色值\n\n\n    var sColorChange = [];\n\n    for (var _i = 1; _i < 7; _i += 2) {\n      sColorChange.push(parseInt('0x' + sColor.slice(_i, _i + 2)));\n    }\n\n    return sColorChange.join(',');\n  }\n\n  return '255,255,255';\n};\nexport var authenticationAdmin = function authenticationAdmin(user) {\n  if (!user.admin) {\n    throw new PermissionDeniedError('抱歉，请使用管理员账号登陆');\n  }\n\n  return true;\n};\nexport var compare = function compare(property) {\n  return function (a, b) {\n    return b[property] - a[property];\n  };\n};\n/* make blocks human readable */\n\nexport var filterBlocks = function filterBlocks(blocks) {\n  if (blocks.constructor !== Array) {\n    var b = blocks;\n    var ascii = hex2ascii(blocks.extraData);\n    b.extraDataHex = blocks.extraData;\n    b.extraData = ascii;\n    return b;\n  }\n\n  return blocks.map(function (block) {\n    var b = block;\n    var ascii = hex2ascii(block.extraData);\n    b.extraDataHex = block.extraData;\n    b.extraData = ascii;\n    return b;\n  });\n};\nexport var filterTrace = function filterTrace(txs, value) {\n  return txs.map(function (tx) {\n    var t = tx;\n\n    if (t.type == 'suicide') {\n      if (t.action.address) t.from = t.action.address;\n      if (t.action.balance) t.value = etherUnits.toEther(new BigNumber(t.action.balance), 'wei');\n      if (t.action.refundAddress) t.to = t.action.refundAddress;\n    } else {\n      if (t.action.to) t.to = t.action.to;\n      t.from = t.action.from;\n      if (t.action.gas) t.gas = new BigNumber(t.action.gas).toNumber();\n      if (t.result && t.result.gasUsed) t.gasUsed = new BigNumber(t.result.gasUsed).toNumber();\n      if (t.result && t.result.address) t.to = t.result.address;\n      t.value = etherUnits.toEther(new BigNumber(t.action.value), 'wei');\n    }\n\n    return t;\n  });\n}; // 千分位\n\nexport var formatDataNumber = function formatDataNumber(num) {\n  num += '';\n  if (!num.includes('.')) num += '.';\n  return num.replace(/(\\d)(?=(\\d{3})+\\.)/g, function ($0, $1) {\n    return $1 + ',';\n  }).replace(/\\.$/, '');\n};\nexport var handleGetFee = function handleGetFee(price, number) {\n  if (!price) {\n    return false;\n  }\n\n  var priceStr = price.toString();\n  var priceLen = priceStr.length;\n\n  if (priceLen > number) {\n    if (number === 0) {\n      return formatDataNumber(priceStr);\n    } else {\n      var pointNumber = priceLen - number;\n\n      if (pointNumber >= 10) {\n        return formatDataNumber(priceStr.substring(0, pointNumber));\n      } else {\n        var feeArr = priceStr.split('');\n        feeArr.splice(priceLen - number, 0, '.');\n        return formatDataNumber(feeArr.join('').substr(0, feeArr[9] === '.' ? 9 : 10));\n      }\n    }\n  } else {\n    var fee = \"0.\".concat(new Array(number - priceLen + 1).join('0')).concat(priceStr);\n    return formatDataNumber(fee.substr(0, 10));\n  }\n};\nexport var analysisInput = function analysisInput(data, number) {\n  var value = data.toString().substring(74);\n  return handleGetFee(new BigNumber(parseInt(value, 16)).toFixed(), number);\n};\nexport var handleAllTrade = function handleAllTrade(index, value, isReg) {\n  var minerRegex = isReg ? new RegExp(['^', value, '$'].join(''), 'i') : value;\n\n  switch (index) {\n    case 'out':\n      return {\n        $or: [{\n          from: minerRegex\n        }, {\n          addr: value\n        }]\n      };\n\n    case 'in':\n      return {\n        $or: [{\n          to: minerRegex\n        }, {\n          addr: value\n        }]\n      };\n\n    case 'all':\n    default:\n      return {\n        $or: [{\n          to: minerRegex\n        }, {\n          from: minerRegex\n        }, {\n          addr: value\n        }]\n      };\n  }\n}; // 判断是否手机\n\nexport var isMobile = function isMobile(userAgent) {\n  var mobileList = new Array('Android', 'iPhone', 'SymbianOS', 'Windows Phone', 'iPad', 'iPod');\n  var mobile = false;\n\n  for (var v = 0; v < mobileList.length; v++) {\n    if (userAgent.indexOf(mobileList[v]) > 0) {\n      mobile = true;\n      break;\n    }\n  }\n\n  return mobile;\n};","map":null,"metadata":{},"sourceType":"module"}